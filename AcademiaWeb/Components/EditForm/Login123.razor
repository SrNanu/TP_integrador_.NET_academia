@page "/Login123"
@using Microsoft.AspNetCore.Components.Forms
@inject NavigationManager Navigation
@inherits LayoutComponentBase
@rendermode InteractiveServer

@using Microsoft.AspNetCore.Components
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Components.Web

<PageTitle>Academia</PageTitle>

<div>
    <h1 style="text-align: center; color: darkblue">ACADEMIA</h1>
</div>

<div class="login-container">
    <h2>Iniciar Sesión</h2>
    <EditForm Model="@loginModel" OnValidSubmit="@HandleLogin" FormName="loginForm">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group">
            <label for="username">Usuario:</label>
            <input type="text" id="username" class="form-control" required bind-Value="@loginModel.Username" />
        </div>

        <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" class="form-control" required bind-Value="@loginModel.Password" />
        </div>

        <button type="submit" class="btn btn-primary">Iniciar Sesión</button>

        <div style="margin-top: 20px;">
            <NavLink href="/CrearUsuario123" class="btn btn-secondary" active-class="active" aria-label="Crear nuevo usuario" style="background-color: indigo"> 
               Crear nuevo usuario
            </NavLink>
        </div>

        @if (showDatos)
        {
            <div>
                <p>Username: @loginModel.Username</p>
                <p>Password: @loginModel.Password</p>
            </div>
        }

        @if (showErrorMessage)
        {
            <div class="alert alert-danger" role="alert" style="margin-top: 20px; color: red">
                Nombre de usuario o contraseña incorrectas. Intente nuevamente.
            </div>
        }

    </EditForm>
</div>

@code {
    private LoginModel loginModel = new LoginModel();
    private bool showErrorMessage = false;
    private bool showDatos = false;

    private async Task HandleLogin()
    {
        var usuario = Usuario_Controller.GetOneUsuarioUsername(loginModel.Username);

        showDatos = true;

        if (usuario != null && usuario.Password == loginModel.Password)
        {
            if (usuario.Tipo == TiposUsuarios.Alumno)
            {
                Navigation.NavigateTo("/MenuAlumno");
            }
            else if (usuario.Tipo == TiposUsuarios.Docente)
            {
                Navigation.NavigateTo("/MenuDocente");
            }
        }
        else
        {
            showErrorMessage = true;
        }

    }

    public class LoginModel
    {
        public string Username { get; set; }
        public string Password { get; set; }
    }
}

<style>
    .login-container {
        display: flex;
        flex-direction: column;
        align-items: center; /* Centra los elementos horizontalmente */
        justify-content: center; /* Centra los elementos verticalmente */
        height: 70vh; /* Toma toda la altura de la ventana */
        background-color: #f8f9fa; /* Fondo claro para el contraste */
    }

    h2 {
        font-size: 2.5rem; /* Tamaño del título */
        margin-bottom: 20px; /* Espacio debajo del título */
    }

    .form-group {
        margin-bottom: 15px; /* Espacio entre los grupos de formulario */
        width: 300px; /* Ancho del formulario */
    }

    .form-control {
        font-size: 1.25rem; /* Aumenta el tamaño de los campos de entrada */
        padding: 10px; /* Espaciado interno de los campos */
    }

    .btn {
        font-size: 1.25rem; /* Aumenta el tamaño del botón */
        padding: 10px 20px; /* Espaciado interno del botón */
    }
</style>
